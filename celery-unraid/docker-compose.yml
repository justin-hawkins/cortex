# Celery Worker for DATS
# Infrastructure configuration is centralized in dats/src/config/servers.yaml
# RabbitMQ: 192.168.1.49:5672
# Redis: 192.168.1.44:6379 (for result backend if needed)

services:
  celery-worker:
    build: .
    container_name: celery-worker
    restart: unless-stopped
    networks:
      - br0
    environment:
      # RabbitMQ broker (matches infrastructure.rabbitmq in servers.yaml)
      - CELERY_BROKER_URL=amqp://guest:guest@192.168.1.49:5672//
      - CELERY_RESULT_BACKEND=rpc://
    volumes:
      - ./app:/app/app:ro
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

networks:
  br0:
    external: true
